!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.$=e.Dom=void 0;var r=function(){function t(t){this.$elem="string"==typeof t?document.querySelector(t):t}return t.prototype.html=function(t){return"string"==typeof t?(this.$elem.innerHTML=t,this):this.$elem.outerHTML.trim()},t.prototype.text=function(t){return void 0!==t?(this.$elem.textContent=t,this):"input"===this.$elem.tagName.toLowerCase()?this.$elem.value.trim():this.$elem.textContent.trim()},t.prototype.clear=function(){return this.html(""),this},t.prototype.on=function(t,e){this.$elem.addEventListener(t,e)},t.prototype.off=function(t,e){this.$elem.removeEventListener(t,e)},t.prototype.append=function(e){return e instanceof t&&(e=e.$elem),this.$elem.appendChild(e),this},t.prototype.closest=function(t){return o(this.$elem.closest(t))},Object.defineProperty(t.prototype,"data",{get:function(){return this.$elem.dataset},enumerable:!1,configurable:!0}),t.prototype.getCoords=function(){return this.$elem.getBoundingClientRect()},t.prototype.find=function(t){return o(this.$elem.querySelector(t))},t.prototype.findAll=function(t){return this.$elem.querySelectorAll(t)},t.prototype.css=function(t){var e=this;Object.entries(t).forEach((function(t){var n=t[0],r=t[1];e.$elem.style[n]=r}))},t.prototype.addClass=function(t){return this.$elem.classList.add(t),this},t.prototype.removeClass=function(t){return this.$elem.classList.remove(t),this},t.prototype.id=function(t){if(t){var e=this.id().split(":");return{row:e[0],col:e[1]}}return this.data.id},t.prototype.focus=function(){return this.$elem.focus(),this},t.prototype.getStyles=function(t){var e=this;return void 0===t&&(t=[]),t.reduce((function(t,n){return t[n]=e.$elem.style[n],t}),{})},t}();function o(t){return new r(t)}e.Dom=r,e.$=o,o.create=function(t,e){void 0===e&&(e="");var n=document.createElement(t);return e&&n.classList.add(e),o(n)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.preventDefault=e.clone=e.storage=void 0,e.storage=function(t,e){if(!e)return JSON.parse(localStorage.getItem(t));localStorage.setItem(t,JSON.stringify(e))},e.clone=function(t){return JSON.parse(JSON.stringify(t))},e.preventDefault=function(t){t.preventDefault()}},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n){var r=t.call(this,e,n.listeners)||this;return r.subscribe=[],r.unsubscribers=[],r.name=n.name||"",r.emitter=n.emitter,r.subscribe=n.subscribe,r.store=n.store,r.unsubscribers,r}return o(e,t),e.prototype.$emit=function(t,e){this.emitter.emit(t,e)},e.prototype.$on=function(t,e){var n=this.emitter.subscribe(t,e);this.unsubscribers.push(n)},e.prototype.$dispatch=function(t){this.store.dispatch(t)},e.prototype.isWatching=function(t){return this.subscribe.includes(t)},e.prototype.init=function(){this.initDOMListeners()},e.prototype.destroy=function(){this.removeDOMListeners(),this.unsubscribers.forEach((function(t){return t()}))},e}(i(n(17)).default);e.default=s},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.normalizeInitialState=e.defaultStyles=e.defaultTitle=void 0;var o=n(1);e.defaultTitle="Новая таблица",e.defaultStyles={textAlign:"left",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"};var i={title:e.defaultTitle,colState:{},rowState:{},dataState:{},currentText:"",currentStyles:e.defaultStyles,stylesState:{},openedDate:(new Date).toJSON()};e.normalizeInitialState=function(t){return t?function(t){return r(r({},t),{currentStyles:e.defaultStyles,currentText:""})}(t):o.clone(i)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.updateDate=e.changeTitle=e.applyStyles=e.changeStyles=e.changeText=e.tableResize=void 0;var r=n(7);e.tableResize=function(t){return{type:r.ActionTypes.TABLE_RESIZE,data:t}};e.changeText=function(t){return{type:r.ActionTypes.CHANGE_TEXT,data:t}};e.changeStyles=function(t){return{type:r.ActionTypes.CHANGE_STYLES,data:t}};e.applyStyles=function(t){return{type:r.ActionTypes.APPLY_STYLE,data:t}};e.changeTitle=function(t){return{type:r.ActionTypes.CHANGE_TITLE,data:t}};e.updateDate=function(){return{type:r.ActionTypes.UPDATE_DATE}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return Object.defineProperty(t,"path",{get:function(){return window.location.hash.slice(1)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"param",{get:function(){return t.path.split("/")[1]},enumerable:!1,configurable:!0}),t.navigate=function(t){window.location.hash=t},t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){this.param=t};e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ActionTypes=void 0,function(t){t.TABLE_RESIZE="TABLE_RESIZE",t.CHANGE_TEXT="CHANGE_TEXT",t.APPLY_STYLE="APPLY_STYLE",t.CHANGE_STYLES="CHANGE_STYLES",t.CHANGE_TITLE="CHANGE_TITLE",t.UPDATE_DATE="UPDATE_DATE"}(e.ActionTypes||(e.ActionTypes={}))},function(t,e,n){t.exports=n(9)},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(10)),i=r(n(11)),s=r(n(12));n(27),new o.default("#application",{excel:s.default,dashboard:i.default})},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=r(n(5)),s=function(){function t(t,e){if(!t)throw new Error("Selector is not provided in Router!");this.$placeholder=o.$(t),this.routes=e,this.page=null,this.changePageHandler=this.changePageHandler.bind(this),this.init()}return t.prototype.init=function(){window.addEventListener("hashchange",this.changePageHandler),this.changePageHandler()},t.prototype.destroy=function(){window.removeEventListener("hashchange",this.changePageHandler)},t.prototype.changePageHandler=function(){var t,e;this.page&&this.page.destroy(),this.$placeholder.clear();var n=i.default.path.includes("excel")?this.routes.excel:this.routes.dashboard;this.page=new n(i.default.param),this.$placeholder.append(null===(t=this.page)||void 0===t?void 0:t.getRoot()),null===(e=this.page)||void 0===e||e.afterRender()},t}();e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.DashboardPage=void 0;var s=i(n(6)),a=n(0),u=n(1),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getRoot=function(){var t=Date.now().toString();return a.$.create("div","db").html('\n      <div class="db__header">\n        <h1>Excel. Панель Управления</h1>\n      </div>\n\n      <div class="db__new">\n        <div class="db__view">\n          <a href="#excel/'+t+'" class="db__create">\n            Новая <br /> Таблица\n          </a>\n        </div>\n      </div>\n\n      <div class="db__table db__view">\n        '+this.createRecordsTable()+"\n      </div>\n    ")},e.prototype.afterRender=function(){console.log("After Render DashboardPage")},e.prototype.destroy=function(){console.log("Destroy DashboardPage")},e.prototype.toHTML=function(t){var e=u.storage(t);return'\n      <li class="db__record">\n        <a href="#excel/'+t.split(":")[1]+'">'+e.title+"</a>\n        <strong>\n          "+new Date(e.openedDate).toLocaleDateString()+"\n          "+new Date(e.openedDate).toLocaleTimeString()+"\n        </strong>\n      </li>\n    "},e.prototype.getAllKeys=function(){for(var t=[],e=0;e<localStorage.length;e++){var n=localStorage.key(e);(null==n?void 0:n.includes("excel"))&&t.push(n)}return t},e.prototype.createRecordsTable=function(){var t=this.getAllKeys();return t.length?'\n      <div class="db__list-header">\n        <span>Название</span>\n        <span>Дата открытия</span>\n      </div>\n  \n      <ul class="db__list">\n        '+t.map(this.toHTML).join("")+"\n      </ul>\n    ":"<p>Вы пока не создали ни одной таблицы</p>"},e}(s.default);e.DashboardPage=c,e.default=c},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=i(n(6)),a=i(n(13)),u=i(n(16)),c=i(n(18)),l=i(n(20)),f=i(n(21)),p=i(n(25)),h=n(26),d=n(1),y=n(3),v=function(t){function e(e){var n=t.call(this,e)||this;return n.excel=null,n.storeSub=null,n}return o(e,t),e.prototype.getRoot=function(){var t=this,e=this.param?this.param:Date.now().toString(),n=d.storage(this.storageName(e)),r=new p.default(h.rootReducer,y.normalizeInitialState(n));return this.storeSub=r.subscribe((function(n){d.storage(t.storageName(e),n)})),this.excel=new a.default({components:[u.default,c.default,l.default,f.default],store:r}),this.excel.getRoot()},e.prototype.afterRender=function(){var t;null===(t=this.excel)||void 0===t||t.init()},e.prototype.destroy=function(){var t;null===(t=this.excel)||void 0===t||t.destroy(),this.storeSub&&this.storeSub()},e.prototype.storageName=function(t){return"excel:"+t},e}(s.default);e.default=v},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=r(n(14)),s=r(n(15)),a=n(1),u=n(4),c=function(){function t(t){this.components=[],this.components=t.components,this.store=t.store,this.emitter=new i.default,this.subscriber=new s.default(this.store)}return t.prototype.getRoot=function(){var t=o.$.create("div","excel"),e={emitter:this.emitter,store:this.store};return this.components=this.components.map((function(n){var r=o.$.create("div",n.className),i=new n(r,e);return r.html(i.toHTML()),t.append(r),i})),t},t.prototype.init=function(){document.addEventListener("contextmenu",a.preventDefault),this.store.dispatch(u.updateDate()),this.subscriber.subscribeComponents(this.components),this.components.forEach((function(t){return t.init()}))},t.prototype.destroy=function(){document.removeEventListener("contextmenu",a.preventDefault),this.subscriber.unsubscribeFromStore(),this.components.forEach((function(t){return t.destroy()}))},t}();e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.listeners={}}return t.prototype.emit=function(t,e){return!!Array.isArray(this.listeners[t])&&(this.listeners[t].forEach((function(t){t(e)})),!0)},t.prototype.subscribe=function(t,e){var n=this;return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),function(){n.listeners[t]=n.listeners[t].filter((function(t){return t!==e}))}},t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.store=t,this.sub=null,this.prevState=this.store.getState()}return t.prototype.subscribeComponents=function(t){var e=this;this.prevState=this.store.getState(),this.sub=this.store.subscribe((function(n){Object.keys(n).forEach((function(r){e.isEqual(e.prevState[r],n[r])||t.forEach((function(t){var e;if(t.isWatching(r)){var o=((e={})[r]=n[r],e);t.storeChanged(o)}}))})),e.prevState=e.store.getState()}))},t.prototype.unsubscribeFromStore=function(){this.sub&&this.sub()},t.prototype.isEqual=function(t,e){return"object"==typeof t&&"object"==typeof e?JSON.stringify(t)===JSON.stringify(e):t===e},t}();e.default=r},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=s(n(2)),u=s(n(5)),c=n(4),l=n(3),f=n(0),p=function(t){function e(e,n){return t.call(this,e,i({name:"Header",listeners:["input","click"],subscribe:[]},n))||this}return o(e,t),e.prototype.storeChanged=function(){console.log("StoreChanged Header")},e.prototype.toHTML=function(){return'\n      <input type="text" class="input" value="'+(this.store.getState().title||l.defaultTitle)+'" />\n      <div>\n        <div class="button" data-button="remove">\n          <i class="material-icons" data-button="remove">delete</i>\n        </div>\n        <div class="button" data-button="exit">\n          <i class="material-icons" data-button="exit">exit_to_app</i>\n        </div>\n      </div>\n    '},e.prototype.onInput=function(t){var e=f.$(t.target);this.$dispatch(c.changeTitle(e.text()))},e.prototype.onClick=function(t){var e=f.$(t.target);"remove"===e.data.button?window.confirm("Вы действительно хотите удалить эту таблицу?")&&(localStorage.removeItem("excel:"+u.default.param),u.default.navigate("")):"exit"===e.data.button&&u.default.navigate("")},e.className="excel__header",e}(a.default);e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){if(this.listeners=[],!t)throw new Error("No $root provided for DomListener!");this.$root=t,this.listeners=e}return t.prototype.initDOMListeners=function(){var t=this;this.listeners.forEach((function(e){var n=t.getMethodName(e);if(!t[n])throw new Error("Method "+n+" is not implemented");t[n]=t[n].bind(t),t.$root.on(e,t[n])}))},t.prototype.removeDOMListeners=function(){var t=this;this.listeners.forEach((function(e){var n=t.getMethodName(e);t.$root.off(e,t[n])}))},t.prototype.getMethodName=function(t){return"on"+t.charAt(0).toUpperCase()+t.slice(1)},t}();e.default=r},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=s(n(19)),u=n(0),c=function(t){function e(e,n){return t.call(this,e,i({name:"Toolbar",listeners:["click"],subscribe:["currentStyles"]},n))||this}return o(e,t),e.prototype.storeChanged=function(t){this.setState(t)},e.prototype.toHTML=function(){return this.template},Object.defineProperty(e.prototype,"template",{get:function(){return this.state.currentStyles?this.createToolbar(this.state.currentStyles):this.createToolbar({})},enumerable:!1,configurable:!0}),e.prototype.onClick=function(t){var e=u.$(t.target);if(e.data.value&&"button"===e.data.type){var n=JSON.parse(e.data.value);this.$emit("toolbar:applyStyle",n)}},e.prototype.createToolbar=function(t){return[{icon:"format_align_left",active:"left"===t.textAlign,value:{textAlign:"left"}},{icon:"format_align_center",active:"center"===t.textAlign,value:{textAlign:"center"}},{icon:"format_align_right",active:"right"===t.textAlign,value:{textAlign:"right"}},{icon:"format_bold",active:"bold"===t.fontWeight,value:{fontWeight:"bold"===t.fontWeight?"normal":"bold"}},{icon:"format_italic",active:"italic"===t.fontStyle,value:{fontStyle:"italic"===t.fontStyle?"normal":"italic"}},{icon:"format_underlined",active:"underline"===t.textDecoration,value:{textDecoration:"underline"===t.textDecoration?"none":"underline"}}].map(this.toButton).join("")},e.prototype.toButton=function(t){var e='data-type="button" data-value=\''+JSON.stringify(t.value)+"'";return'\n      <div \n        class="button '+(t.active?"active":"")+'"\n        '+e+'\n      >\n        <i class="material-icons" '+e+">"+t.icon+"</i>\n      </div>\n    "},e.className="excel__toolbar",e}(a.default);e.default=c},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=e.store.getState(),e}return o(e,t),Object.defineProperty(e.prototype,"template",{get:function(){return JSON.stringify(this.state,null,2)},enumerable:!1,configurable:!0}),e.prototype.initState=function(t){this.state=i({},t)},e.prototype.setState=function(t){this.state=i(i({},this.state),t),this.$root.html(this.template)},e}(s(n(2)).default);e.default=a},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=s(n(2)),u=n(0),c=function(t){function e(e,n){var r=t.call(this,e,i({name:"Formula",listeners:["input","keydown"],subscribe:["currentText"]},n))||this;return r.$formula=null,r.$root=e,r}return o(e,t),e.prototype.init=function(){var e=this;t.prototype.init.call(this),this.$formula=this.$root.find("#formula"),this.$on("table:select",(function(t){t instanceof u.Dom&&e.$formula&&e.$formula.text(t.text())}))},e.prototype.toHTML=function(){return'\n      <div class="info">fx</div>\n      <div id="formula" class="input" contenteditable spellcheck="false"></div>\n    '},e.prototype.storeChanged=function(t){var e=t.currentText;this.$formula&&this.$formula.text(e)},e.prototype.onInput=function(t){this.$emit("formula:input",u.$(t.target).text())},e.prototype.onKeydown=function(t){["Enter","Tab"].includes(t.key)&&(t.preventDefault(),this.$emit("formula:done"))},e.className="excel__formula",e}(a.default);e.default=c},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&s(e,t,n);return a(e,t),e},c=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},l=this&&this.__generator||function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},f=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var p=f(n(2)),h=f(n(22)),d=n(23),y=n(3),v=f(n(24)),_=u(n(4)),b=n(0),g=function(t){function e(e,n){var r=t.call(this,e,i({name:"Table",listeners:["mousedown","keydown","input"],subscribe:[]},n))||this;return r.$root=e,r.selection=new v.default,r}return o(e,t),e.prototype.storeChanged=function(){console.log("StoreChanged Table")},e.prototype.init=function(){var e=this;t.prototype.init.call(this),this.selectCell(this.$root.find('[data-id="0:0"]')),this.$on("formula:input",(function(t){var n;"string"==typeof t&&(null===(n=e.selection.current)||void 0===n||n.text(t),e.updateTextInStore(t))})),this.$on("formula:done",(function(){var t;null===(t=e.selection.current)||void 0===t||t.focus()})),this.$on("toolbar:applyStyle",(function(t){"string"==typeof t||void 0===t||t instanceof b.Dom||(e.selection.applyStyle(t),e.$dispatch(_.applyStyles({value:t,ids:e.selection.selectedIds})))}))},e.prototype.toHTML=function(){return new h.default(50,this.store.getState()).createTable()},e.prototype.selectCell=function(t){this.selection.select(t),this.$emit("table:select",t);var e=t.getStyles(Object.keys(y.defaultStyles));this.$dispatch(_.changeStyles(e))},e.prototype.resizeTable=function(t){return c(this,void 0,void 0,(function(){var e,n;return l(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,d.resizeHandler(this.$root,t)];case 1:return e=r.sent(),this.$dispatch(_.tableResize(e)),[3,3];case 2:return n=r.sent(),console.warn("Resize error",n.message),[3,3];case 3:return[2]}}))}))},e.prototype.onMousedown=function(t){var e=this;if(this.shouldResize(t))this.resizeTable(t);else if(this.isCell(t)){var n=b.$(t.target);if(t.shiftKey){var r=this.matrix(n,this.selection.current).map((function(t){return e.$root.find('[data-id="'+t+'"]')}));this.selection.selectGroup(r)}else this.selectCell(n)}},e.prototype.onKeydown=function(t){var e;if(["Enter","Tab","ArrowLeft","ArrowRight","ArrowDown","ArrowUp"].includes(t.key)&&!t.shiftKey){t.preventDefault();var n=null===(e=this.selection.current)||void 0===e?void 0:e.id(!0),r=this.$root.find(this.nextSelector(t.key,n));this.selectCell(r)}},e.prototype.updateTextInStore=function(t){this.selection.current&&this.$dispatch(_.changeText({id:this.selection.current.id(),value:t}))},e.prototype.onInput=function(t){this.updateTextInStore(b.$(t.target).text())},e.prototype.shouldResize=function(t){var e=t.target;return Boolean(e.dataset.resize)},e.prototype.isCell=function(t){return"cell"===t.target.dataset.type},e.prototype.matrix=function(t,e){var n=t.id(!0),r=e.id(!0),o=this.range(Number.parseInt(r.col),Number.parseInt(n.col)),i=this.range(Number.parseInt(r.row),Number.parseInt(n.row));return o.reduce((function(t,e){return i.forEach((function(n){return t.push(n+":"+e)})),t}),[])},e.prototype.nextSelector=function(t,e){var n=Number.parseInt(e.col),r=Number.parseInt(e.row);switch(t){case"Enter":case"ArrowDown":r++;break;case"Tab":case"ArrowRight":n++;break;case"ArrowLeft":n=n-1<0?0:n-1;break;case"ArrowUp":r=r-1<0?0:r-1}return'[data-id="'+r+":"+n+'"]'},e.prototype.range=function(t,e){var n;return t>e&&(e=(n=[t,e])[0],t=n[1]),new Array(e-t+1).fill("").map((function(e,n){return t+n}))},e.className="excel__table",e}(p.default);e.default=g},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),i=function(){function t(t,e){void 0===t&&(t=50),this.rowsCount=t,this.state=e}return t.prototype.createTable=function(){var e=t.CODES.Z-t.CODES.A+1,n=[],r=new Array(e).fill("").map(this.toChar).map(this.withWidthFrom(this.state.colState)).map(this.toColumn).join("");n.push(this.createRow(null,r,{}));for(var o=0;o<this.rowsCount;o++){var i=new Array(e).fill("").map(this.toCell(this.state,o)).join("");n.push(this.createRow(o+1,i,this.state.rowState))}return n.join("")},t.prototype.toChar=function(e,n){return String.fromCharCode(t.CODES.A+n)},t.prototype.withWidthFrom=function(t){var e=this.getWidth.bind(this);return function(n,r){return{col:n,index:r,width:e(t,r)}}},t.prototype.getWidth=function(e,n){return(e[n]||t.DEFAULT_WIDTH)+"px"},t.prototype.toColumn=function(t){var e=t.col;return'\n      <div class="column" data-type="resizable" data-col="'+t.index+'" style="width: '+t.width+'">\n        '+e+'\n        <div class="col-resize" data-resize="col"></div>\n      </div>\n    '},t.prototype.createRow=function(t,e,n){var r=t?'<div class="row-resize" data-resize="row"></div>':"";return'\n      <div class="row" data-type="resizable" data-row="'+t+'" style="height: '+this.getHeight(n,t)+'">\n        <div class="row-info">\n          '+(t||"")+"\n          "+r+'\n        </div>\n        <div class="row-data">'+e+"</div>\n      </div>\n    "},t.prototype.getHeight=function(e,n){return(n&&e[n]||t.DEFAULT_HEIGHT)+"px"},t.prototype.toCell=function(t,e){var n=this.getWidth.bind(this),i=this.toInlineStyles.bind(this);return function(s,a){var u=n(t.colState,a),c=e+":"+a,l=t.dataState&&t.dataState[c];return'\n        <div class="cell" \n          contenteditable \n          data-col="'+a+'" \n          data-type="cell"\n          data-id="'+c+'"\n          style="'+i(r(r({},o.defaultStyles),t.stylesState[c]))+"; width: "+u+'"\n        >'+(l||"")+"</div>\n      "}},t.prototype.toInlineStyles=function(t){var e=this;return void 0===t&&(t={}),Object.keys(t).map((function(n){return e.camelToDashCase(n)+": "+t[n]})).join(";")},t.prototype.camelToDashCase=function(t){return t.replace(/([A-Z])/g,(function(t){return"-"+t[0].toLowerCase()}))},t.CODES={A:65,Z:90},t.DEFAULT_WIDTH=120,t.DEFAULT_HEIGHT=24,t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resizeHandler=void 0;var r=n(0);e.resizeHandler=function(t,e){return new Promise((function(n){var o,i,s=r.$(e.target),a=s.closest('[data-type="resizable"]'),u=a.getCoords(),c=s.data.resize,l="col"===c?"bottom":"right";s.css(((o={opacity:1})[l]="-5000px",o)),document.onmousemove=function(t){if("col"===c){var e=t.pageX-u.right;i=u.width+e,s.css({right:-e+"px"})}else{e=t.pageY-u.bottom;i=u.height+e,s.css({bottom:-e+"px"})}},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,"col"===c?(a.css({width:i+"px"}),t.findAll('[data-col="'+a.data.col+'"]').forEach((function(t){return t.style.width=i+"px"}))):a.css({height:i+"px"}),void 0!==c&&(n({id:a.data[c],type:c,value:i}),s.css({opacity:0,bottom:0,right:0}))}}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.group=[],this.current=null}return t.prototype.clear=function(){this.group.forEach((function(e){return e.removeClass(t.className)})),this.group=[]},t.prototype.select=function(e){this.clear(),e.focus().addClass(t.className),this.group.push(e),this.current=e},t.prototype.selectGroup=function(e){void 0===e&&(e=[]),this.clear(),this.group=e,this.group.forEach((function(e){return e.addClass(t.className)}))},t.prototype.applyStyle=function(t){this.group.forEach((function(e){return e.css(t)}))},Object.defineProperty(t.prototype,"selectedIds",{get:function(){return this.group.map((function(t){return t.id()}))},enumerable:!1,configurable:!0}),t.className="selected",t}();e.default=r},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){this.rootReducer=t,this.state=r({},e),this.listeners=[]}return t.prototype.subscribe=function(t){var e=this;return this.listeners.push(t),function(){e.listeners=e.listeners.filter((function(e){return e!==t}))}},t.prototype.dispatch=function(t){var e=this;this.state=this.rootReducer(this.state,t),this.listeners.forEach((function(t){return t(e.state)}))},t.prototype.getState=function(){return JSON.parse(JSON.stringify(this.state))},t}();e.default=o},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.rootReducer=void 0;var o=n(7);e.rootReducer=function(t,e){var n,i,s;switch(e.type){case o.ActionTypes.TABLE_RESIZE:var a=t[c="col"===e.data.type?"colState":"rowState"],u=e.data.id.toString();return a&&(a[u]=e.data.value),r(r({},t),((n={})[c]=a,n));case o.ActionTypes.CHANGE_TEXT:return(a=t[c="dataState"])&&(a[e.data.id]=e.data.value),r(r({},t),((i={currentText:e.data.value})[c]=a,i));case o.ActionTypes.CHANGE_STYLES:return r(r({},t),{currentStyles:e.data});case o.ActionTypes.APPLY_STYLE:var c,l=t[c="stylesState"]||{};return e.data.ids.forEach((function(t){l[t]=r(r({},l[t]),e.data.value)})),r(r({},t),((s={})[c]=l,s.currentStyles=r(r({},t.currentStyles),e.data.value),s));case o.ActionTypes.CHANGE_TITLE:return r(r({},t),{title:e.data});case o.ActionTypes.UPDATE_DATE:return r(r({},t),{openedDate:(new Date).toJSON()});default:return t}}},function(t,e,n){}]);